# PHinterland Hack - Object Detection & Classification

Our solution for the Weidm√ºller challenge at Hinterland of Things 2025. We built a computer vision pipeline that segments, extracts, aligns, and compares objects from images.

The system has four main parts: **`app_segmentation.py`** uses SAM 2.0/2.1 for interactive image segmentation, **`app_alignment.py`** extracts and aligns individual objects from binary masks, **`app_matching.py`** performs sophisticated rotation/scale optimization for optimal object alignment, and **`app_classifier.py`** compares objects with templates using multiple similarity metrics. The pipeline uses advanced CV techniques including IoU, SSIM, keypoint extraction, and comprehensive rotation testing.

Main features: SAM 2.0/2.1-based segmentation, binary mask processing, object extraction with rotation alignment, sophisticated template matching with rotation/scale combinations, and multi-metric similarity scoring. Outputs include segmented masks, aligned object cuts, overlay visualizations, and detailed JSON comparison results.

## üéØ Challenge Background

This solution addresses the **Weidm√ºller Challenge** from Hinterland Hack 2025: developing an AI-powered visual quality control system for automated anomaly detection in manufacturing. The challenge involved creating a proof-of-concept that can reliably distinguish between good and defective parts from production line images of terminal blocks, despite flexible part positioning and high product variance. Our computer vision pipeline tackles object recognition, alignment, and template-based comparison to enable scalable quality control across different products and production lines.

## üåê Web Application

We also provide a **Flask web interface** for easy image processing:

<img src="resourses/gui.png" alt="Web Application GUI" width="600">

- **Upload images** through a modern drag-and-drop interface
- **Interactive segmentation** with optional point selection for guided processing  
- **Real-time results** showing masks and extracted objects
- **Gallery view** with zoom functionality for detailed inspection

**Quick Start:**
```bash
python3 app.py
# Access at http://localhost:5001
```

The web app integrates the processing modules into a seamless workflow - upload an image, get segmentation masks, and view the aligned object cuts in your browser.

## üìä JSON Output Structure

The system outputs detailed classification results in JSON format. Here's the structure:

```
Classification Results JSON
‚îú‚îÄ‚îÄ [Object_Name].png                    # Source object being analyzed
‚îÇ   ‚îú‚îÄ‚îÄ [Template_Name].png              # Template being compared against
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ metrics                      # Computer vision metrics
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ssim: float             # Structural Similarity Index (0-1, higher = more similar)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mse: float              # Mean Squared Error (lower = more similar)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ psnr: float             # Peak Signal-to-Noise Ratio (higher = better quality)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ncc: float              # Normalized Cross-Correlation (0-1, higher = more similar)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ histogram_correlation: float  # Color distribution similarity (0-1)
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ edge_similarity: float  # Edge pattern matching score (0-1)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ alignment_info               # Spatial alignment details
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ overlap_score: float    # How well objects overlap (0-1)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ best_position: [x, y]   # Optimal alignment coordinates
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ transformation_applied: bool  # Whether alignment was performed
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ point_similarity: float     # Keypoint matching score (0-1)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keypoints_count             # Feature detection results
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ object: int             # Keypoints found in source object
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ template: int           # Keypoints found in template
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ edge_image: string          # Path to edge comparison visualization
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aligned_comparison: string  # Path to side-by-side comparison
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ object_aligned_path: string # Path to aligned source object
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ template_aligned_path: string # Path to aligned template
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ object_path: string         # Original object image path
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ template_path: string       # Original template image path
‚îÇ   ‚îî‚îÄ‚îÄ [Additional_Templates]...        # More template comparisons
‚îî‚îÄ‚îÄ [Additional_Objects]...              # More source objects
```

**Key Metrics Explained:**
- **SSIM** (0.0-1.0): Structural similarity - values >0.6 indicate good matches, >0.9 excellent
- **PSNR** (dB): Peak signal-to-noise ratio - higher values mean better quality/alignment
- **NCC** (0.0-1.0): Normalized cross-correlation - measures linear relationship between images
- **Overlap Score** (0.0-1.0): Spatial overlap after optimal rotation/scale alignment
- **Point Similarity** (0.0-1.0): Keypoint-based shape comparison using sophisticated geometric methods

## üìÑ License

This project is released into the public domain under the Unlicense.